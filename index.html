<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style_tradutor.css">
    <title>CVJourney</title>
</head>
<body>
    <div id="centra">
        <h3 id="titulo_esc">Escolha seu idioma</h3>
        <select name="idioma_name" id="idioma">
            <option value="af">Afrikaans</option>
            <option value="bn">Bengali</option>
            <option value="bg">ğŸ‡§ğŸ‡¬ BÃºlgaro</option>
            <option value="ca">ğŸ‡¨ğŸ‡¦ CatalÃ£o</option>
            <option value="zh-CN">ğŸ‡¨ğŸ‡³ ChinÃªs Simplificado</option>
            <option value="hr">ğŸ‡­ğŸ‡· Croata</option>
            <option value="cs">ğŸ‡¨ğŸ‡¿ Tcheco</option>
            <option value="da">ğŸ‡©ğŸ‡° DinamarquÃªs</option>
            <option value="nl">ğŸ‡³ğŸ‡± HolandÃªs</option>
            <option value="en">ğŸ‡¬ğŸ‡§ InglÃªs</option>
            <option value="et">Estoniano</option>
            <option value="fi">ğŸ‡«ğŸ‡® FinlandÃªs</option>
            <option value="fr">ğŸ‡«ğŸ‡· FrancÃªs</option>
            <option value="de">ğŸ‡©ğŸ‡ª AlemÃ£o</option>
            <option value="el">ğŸ‡¬ğŸ‡· Grego</option>
            <option value="gu">Gujarati</option>
            <option value="he">ğŸ‡®ğŸ‡± Hebraico</option>
            <option value="hi">Hindi</option>
            <option value="hu">ğŸ‡­ğŸ‡º HÃºngaro</option>
            <option value="is">ğŸ‡®ğŸ‡¸ IslandÃªs</option>
            <option value="id">ğŸ‡®ğŸ‡© IndonÃ©sio</option>
            <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
            <option value="ja">ğŸ‡¯ğŸ‡µ JaponÃªs</option>
            <option value="kn">Kannada</option>
            <option value="ko">ğŸ‡°ğŸ‡· Coreano</option>
            <option value="lv">LetÃ£o</option>
            <option value="lt">Lituano</option>
            <option value="ml">Malayalam</option>
            <option value="mr">Marathi</option>
            <option value="no">ğŸ‡³ğŸ‡´ NorueguÃªs</option>
            <option value="fa">ğŸ‡®ğŸ‡· Persa</option>
            <option value="pl">ğŸ‡µğŸ‡± PolonÃªs</option>
            <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
            <option value="pa">Punjabi</option>
            <option value="ro">ğŸ‡·ğŸ‡´ Romeno</option>
            <option value="ru">ğŸ‡·ğŸ‡º Russo</option>
            <option value="sk">ğŸ‡¸ğŸ‡° Eslovaco</option>
            <option value="sl">ğŸ‡¸ğŸ‡® Esloveno</option>
            <option value="es">ğŸ‡ªğŸ‡¸ Espanhol</option>
            <option value="sw">SuaÃ­li</option>
            <option value="sv">ğŸ‡¸ğŸ‡ª Sueco</option>
            <option value="ta">TÃ¢mil</option>
            <option value="te">Telugu</option>
            <option value="th">ğŸ‡¹ğŸ‡­ TailandÃªs</option>
            <option value="tr">ğŸ‡¹ğŸ‡· Turco</option>
            <option value="uk">ğŸ‡ºğŸ‡¦ Ucraniano</option>
            <option value="ur">Urdu</option>
            <option value="vi">ğŸ‡»ğŸ‡³ Vietnamita</option>
            <option value="zu">ZulÃº</option>
        </select>
        <h4>
            esse idioma sera utilizado no inicio da sua jornada, <br> mas podes troca-la.
        </h4>
        <button id="avanca">AvanÃ§ar</button>
    </div>

    <script>

        document.getElementById("avanca").addEventListener("click", () => {
            let select = document.getElementById("idioma").value;
            localStorage.setItem("idioma",select)
            console.log(select);

            const request = indexedDB.open("idiomas", 1);

            request.onupgradeneeded = function(event) {
                const db = event.target.result;

                if (!db.objectStoreNames.contains("usuarios")) {
                    db.createObjectStore("usuarios", { keyPath: "id", autoIncrement: true });
                }
            };

            request.onsuccess = function(event) {
                const db = event.target.result;

                const tx = db.transaction("usuarios", "readwrite");
                const store = tx.objectStore("usuarios");

                // ğŸ‘‰ Limpar os dados antigos
                const clearRequest = store.clear();

                clearRequest.onsuccess = () => {
                    console.log("Dados antigos apagados.");

                    // ğŸ‘‰ Adicionar novo idioma
                    const usuario = { idioma: select };
                    const addRequest = store.add(usuario);

                    addRequest.onsuccess = () => console.log("Idioma escolhido com sucesso.");
                    addRequest.onerror = () => console.error("Erro ao adicionar o idioma.");
                };

                clearRequest.onerror = () => {
                    console.error("Erro ao limpar dados antigos.");
                };
            };

            request.onerror = function(event) {
                console.error("Erro ao abrir o banco:", event.target.error);
            };

            window.location.href="login.html"

        });
    </script>
    <script src="script_entrada.js"></script>
</body>
</html>